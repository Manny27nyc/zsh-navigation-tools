# Copy this file into /usr/share/zsh/[-version-]/functions
# and add 'autoload v-history` to .zshrc
#
# This function allows to browse Z shell's history and use the
# entries
#
# Uses n-list

emulate -L zsh

setopt localoptions extendedglob
zmodload zsh/curses
local IFS="
"

local list
local selected

NLIST_REMEMBER_STATE=0

list=( `history -rn 1` )
list=( "${(@M)list:#(#i)*$1*}" )

local NLIST_GREP_STRING="$1"

if [ "$#list" -eq 0 ]; then
    echo "No matching history entries"
    return 1
fi

n-list "${list[@]}"

if [ "$REPLY" -gt 0 ]; then
    selected="$reply[$REPLY]"
    print -zr "$selected"
fi

# vim: set filetype=zsh:
